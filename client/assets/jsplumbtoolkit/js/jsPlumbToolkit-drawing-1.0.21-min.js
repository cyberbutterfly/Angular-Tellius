(function(){"use strict";var a=this;a.jsPlumbToolkit.DrawingTools=function(a){var b,c,d,e,f,g,h,i,j,k=a.renderer,l=k.getToolkit(),m=k.getJsPlumb(),n={},o=a.widthAttribute||"w",p=a.heightAttribute||"h",q=a.leftAttribute||"left",r=a.topAttribute||"top",s=function(){for(var a in n){var b=n[a];b[0]&&b[0].parentNode&&b[0].parentNode.removeChild(b[0]),delete n[a]}},t=function(a,b,c,d){var e=document.createElement(a);if(b&&(e.className=b),c&&c.appendChild(e),d)for(var f in d)e.setAttribute(f,d[f]);return e},u=function(a){var b=n[a];b&&b[0]&&b[0].parentNode&&b[0].parentNode.removeChild(b[0]),delete n[a]},v=function(a,b){var c=b.getRenderedNode(a.id);return u(a.id),c},w=function(a,b){var c=v(a,b);if(null!=c){var d=t("div","jtk-draw-skeleton",c),e=c.getAttribute("jtk-x-resize"),f=c.getAttribute("jtk-y-resize");t("div","jtk-draw-drag",d),t("div","jtk-draw-handle jtk-draw-handle-tl",d,{"data-dir":"tl","data-node-id":a.id}),t("div","jtk-draw-handle jtk-draw-handle-tr",d,{"data-dir":"tr","data-node-id":a.id}),t("div","jtk-draw-handle jtk-draw-handle-bl",d,{"data-dir":"bl","data-node-id":a.id}),t("div","jtk-draw-handle jtk-draw-handle-br",d,{"data-dir":"br","data-node-id":a.id}),n[a.id]=[d,"false"!==e,"false"!==f]}},x=function(a,d,e,f){var k={};return k[o]=b?e:h-g,k[p]=c?f:j-i,k[q]=b?a:g,k[r]=c?d:i,k},y={tl:function(a,b){var c=g+a,d=i+b,e=h-c,f=j-d;return c>=h&&(e=c-h,c=h),d>=j&&(f=d-j,d=j),x(c,d,e,f)},tr:function(a,b){var c=h-g+a,d=i+b,e=j-d,f=g;return 0>=c&&(f=g+c,c*=-1),d>=j&&(e=d-j,d=j),x(f,d,c,e)},bl:function(a,b){var c=g+a,d=j-i+b,e=h-c,f=i;return c>=h&&(e=c-h,c=h),0>=d&&(f+=d,d*=-1),x(c,f,e,d)},br:function(a,b){var c=h-g+a,d=j-i+b,e=g,f=i;return 0>=c&&(e=g+c,c*=-1),0>=d&&(f+=d,d*=-1),x(e,f,c,d)}};l.bind("selectionCleared",function(){s()}),l.bind("select",function(a){w(a.obj,k)}),l.bind("deselect",function(a){v(a.obj,k)});var z=function(a){var b=k.mapEventLocation(a),c=b.left-d.left,g=b.top-d.top,h=e(c,g,"");l.updateNode(f,h),k.setPosition(f,h[q],h[r],!0)},A=function(a){k.storePositionInModel(f.id),m.removeClass(document.body,"jtk-drag-select-defeat"),m.off(document,"mousemove",z),m.off(document,"mouseup",A),jsPlumbUtil.consume(a)};m.on(document,"mousedown",".jtk-draw-handle",function(a){var o=this.getAttribute("data-dir"),p=this.getAttribute("data-node-id");f=l.getNode(p),b=n[p][1],c=n[p][2],d=k.mapEventLocation(a);var q=k.getCoordinates(f);g=q.x,i=q.y,h=g+q.w,j=i+q.h,e=y[o],m.addClass(document.body,"jtk-drag-select-defeat"),m.on(document,"mousemove",z),m.on(document,"mouseup",A)})}}).call("undefined"!=typeof window?window:this);